#!/usr/bin/make -f

DESTDIR		= $(CURDIR)/debian/rubinius
BIN_DIR		= /usr/bin
MAN_DIR		= /usr/share/man/man1
INC_DIR		= /usr/include/rubinius
LIB_DIR		= /usr/lib
GEM_DIR		= /var/lib/gems/rubinius
SYSTEM_NAME	= $(shell dpkg-vendor --query Vendor)
LLVM_CONFIG	= /usr/bin/llvm-config-2.8

%:
	dh $@

override_dh_auto_configure:
	./configure \
		--system-name=$(SYSTEM_NAME) \
		--bindir=$(BIN_DIR) \
		--includedir=$(INC_DIR) \
		--libdir=$(LIB_DIR) \
		--mandir=$(MAN_DIR) \
		--gemsdir=$(GEM_DIR) \
		--llvm-config=$(LLVM_CONFIG)

override_dh_auto_build:
	rake build

override_dh_auto_install:
	FAKEROOT=$(DESTDIR) rake install

override_dh_auto_clean: override_dh_auto_configure
	dh_auto_clean
	cp web/_includes/instructions.markdown /tmp/instructions.markdown
	rake distclean
	cp /tmp/instructions.markdown web/_includes/instructions.markdown

override_dh_clean:
	dh_clean --exclude=vm/external_libs/libgdtoa/makefile.orig

# vim: ts=8 sw=8 noexpandtab
